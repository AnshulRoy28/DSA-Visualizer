<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binary Search Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        .search-container {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            padding: 20px;
        }

        .cell {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-weight: bold;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            transition: all 0.3s;
            position: relative;
        }

        .cell .index {
            position: absolute;
            top: -18px;
            font-size: 10px;
            color: #64748b;
        }

        .cell-idle {
            background: linear-gradient(135deg, #475569, #334155);
            border: 2px solid #64748b;
        }

        .cell-active {
            background: linear-gradient(135deg, #a78bfa, #8b5cf6);
            border: 2px solid #c4b5fd;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
        }

        .cell-mid {
            background: linear-gradient(135deg, #fcd34d, #f59e0b);
            border: 2px solid #fde68a;
            box-shadow: 0 0 25px rgba(251, 191, 36, 0.6);
            transform: scale(1.1);
        }

        .cell-eliminated {
            background: linear-gradient(135deg, #374151, #1f2937);
            border: 2px solid #4b5563;
            opacity: 0.4;
        }

        .cell-found {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            border: 2px solid #86efac;
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.6);
            transform: scale(1.15);
        }

        .cell-left {
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            border: 2px solid #93c5fd;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
        }

        .cell-right {
            background: linear-gradient(135deg, #f472b6, #ec4899);
            border: 2px solid #f9a8d4;
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.4);
        }

        .pointer {
            position: absolute;
            font-size: 10px;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .pointer-low {
            bottom: -22px;
            background: #22c55e;
            color: white;
        }

        .pointer-high {
            bottom: -22px;
            background: #ef4444;
            color: white;
        }

        .pointer-mid {
            top: -22px;
            background: #f59e0b;
            color: black;
        }

        .code-panel {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            line-height: 1.5;
        }

        .code-line {
            padding: 2px 6px;
            border-radius: 4px;
        }

        .code-line.active {
            background: rgba(245, 158, 11, 0.3);
            border-left: 3px solid #f59e0b;
        }

        .code-line-number {
            color: #64748b;
            width: 20px;
            display: inline-block;
            text-align: right;
            margin-right: 8px;
        }

        .btn-control {
            padding: 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-play {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        .btn-pause {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .btn-step {
            background: rgba(71, 85, 105, 0.5);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }

        .btn-step:disabled {
            opacity: 0.4;
        }

        .metric {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
        }

        .metric-value {
            font-size: 20px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            cursor: pointer;
        }

        .status-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-ready {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
        }

        .status-searching {
            background: rgba(245, 158, 11, 0.2);
            color: #fcd34d;
        }

        .status-paused {
            background: rgba(139, 92, 246, 0.2);
            color: #c4b5fd;
        }

        .status-found {
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
        }

        .status-notfound {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 3px 6px;
            font-size: 10px;
        }

        .legend-color {
            width: 14px;
            height: 14px;
            border-radius: 4px;
        }

        .target-display {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            color: black;
            padding: 8px 20px;
            border-radius: 12px;
            font-size: 24px;
            font-weight: bold;
            font-family: 'JetBrains Mono', monospace;
        }
    </style>
</head>

<body class="text-white">
    <div class="container mx-auto p-4 max-w-7xl">
        <header class="mb-4">
            <a href="../index.html"
                class="inline-flex items-center gap-2 text-slate-400 hover:text-amber-400 transition mb-2 text-sm">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                Back to Home
            </a>
            <div class="flex items-center gap-3">
                <div
                    class="w-10 h-10 rounded-xl bg-gradient-to-br from-amber-500 to-orange-500 flex items-center justify-center text-lg shadow-lg shadow-amber-500/30">
                    üîç</div>
                <div>
                    <h1
                        class="text-xl font-bold bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent">
                        Binary Search Visualizer</h1>
                    <p class="text-slate-400 text-xs">Divide & Conquer ‚Ä¢ O(log n) ‚Ä¢ Sorted array</p>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
            <div class="lg:col-span-4 space-y-3">
                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Array & Target</h2>
                    <div class="mb-3">
                        <label class="text-xs text-slate-400">Size</label>
                        <input type="range" id="sizeSlider" min="7" max="15" value="11"
                            class="slider w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer mt-1">
                        <div class="text-center text-amber-400 font-mono text-xs" id="sizeValue">11</div>
                    </div>
                    <div class="mb-3">
                        <label class="text-xs text-slate-400">Target Value</label>
                        <input type="number" id="targetInput"
                            class="w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-sm mt-1 font-mono"
                            value="42">
                    </div>
                    <button onclick="generateArray()"
                        class="w-full bg-gradient-to-r from-slate-600 to-slate-700 py-2 rounded-lg font-semibold text-xs mb-2">Generate
                        Array</button>
                    <button onclick="setRandomTarget()"
                        class="w-full bg-gradient-to-r from-amber-600 to-orange-600 py-2 rounded-lg font-semibold text-xs">Random
                        Target (in array)</button>
                </div>

                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Playback</h2>
                    <div class="flex items-center justify-center gap-2 mb-3">
                        <button id="stepBackBtn" onclick="stepBack()" class="btn-control btn-step w-10 h-10" disabled>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.333 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z" />
                            </svg>
                        </button>
                        <button id="playPauseBtn" onclick="togglePlayPause()" class="btn-control btn-play w-12 h-12">
                            <svg id="playIcon" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z" />
                            </svg>
                            <svg id="pauseIcon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" />
                            </svg>
                        </button>
                        <button id="stepForwardBtn" onclick="stepForward()" class="btn-control btn-step w-10 h-10"
                            disabled>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M11.933 12.8a1 1 0 000-1.6L6.6 7.2A1 1 0 005 8v8a1 1 0 001.6.8l5.333-4zM19.933 12.8a1 1 0 000-1.6l-5.333-4A1 1 0 0013 8v8a1 1 0 001.6.8l5.333-4z" />
                            </svg>
                        </button>
                    </div>
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-400">Speed</span>
                        <span id="speedValue" class="text-amber-400 font-mono">1x</span>
                    </div>
                    <input type="range" id="speedSlider" min="0.5" max="5" step="0.5" value="1"
                        class="slider w-full h-2 bg-slate-700 rounded-lg">
                    <div class="flex items-center justify-between mt-2 pt-2 border-t border-slate-700/50">
                        <span class="text-slate-400 text-xs">Status</span>
                        <span id="statusBadge" class="status-badge status-ready">Ready</span>
                    </div>
                    <label class="flex items-center gap-2 text-xs text-slate-400 cursor-pointer mt-2">
                        <input type="checkbox" id="audioToggle" class="w-3 h-3 rounded">
                        <span>üîä Audio</span>
                    </label>
                </div>

                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Metrics</h2>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="metric">
                            <div class="text-xs text-slate-400">Iterations</div>
                            <div class="metric-value text-amber-400" id="iterations">0</div>
                        </div>
                        <div class="metric">
                            <div class="text-xs text-slate-400">Remaining</div>
                            <div class="metric-value text-purple-400" id="remaining">0</div>
                        </div>
                    </div>
                </div>

                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Algorithm</h2>
                    <div class="code-panel bg-slate-900/50 rounded-lg p-2">
                        <div class="code-line" data-line="1"><span class="code-line-number">1</span>low = 0, high = n-1
                        </div>
                        <div class="code-line" data-line="2"><span class="code-line-number">2</span><span
                                class="text-purple-400">while</span> low <= high:</div>
                                <div class="code-line" data-line="3"><span class="code-line-number">3</span> mid =
                                    (low+high) / 2</div>
                                <div class="code-line" data-line="4"><span class="code-line-number">4</span> <span
                                        class="text-purple-400">if</span> arr[mid] == target:</div>
                                <div class="code-line" data-line="5"><span class="code-line-number">5</span> <span
                                        class="text-purple-400">return</span> mid</div>
                                <div class="code-line" data-line="6"><span class="code-line-number">6</span> <span
                                        class="text-purple-400">elif</span> arr[mid] < target:</div>
                                        <div class="code-line" data-line="7"><span class="code-line-number">7</span> low
                                            = mid + 1</div>
                                        <div class="code-line" data-line="8"><span class="code-line-number">8</span>
                                            <span class="text-purple-400">else</span>: high = mid - 1</div>
                                </div>
                        </div>

                        <div class="glass-card rounded-xl p-3">
                            <h2 class="text-xs font-semibold mb-2 text-slate-300">Legend</h2>
                            <div class="grid grid-cols-2 gap-1">
                                <div class="legend-item">
                                    <div class="legend-color"
                                        style="background: linear-gradient(135deg, #a78bfa, #8b5cf6)"></div>Active
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color"
                                        style="background: linear-gradient(135deg, #fcd34d, #f59e0b)"></div>Mid
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color"
                                        style="background: linear-gradient(135deg, #60a5fa, #3b82f6)"></div>Go Left
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color"
                                        style="background: linear-gradient(135deg, #f472b6, #ec4899)"></div>Go Right
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #374151; opacity: 0.4"></div>Eliminated
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color"
                                        style="background: linear-gradient(135deg, #4ade80, #22c55e)"></div>Found
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-8 space-y-3">
                        <div class="glass-card rounded-xl p-4">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xs font-semibold text-slate-300">Target</h3>
                                <div id="targetDisplay" class="target-display">42</div>
                            </div>
                            <div id="arrayContainer" class="search-container min-h-[120px]"></div>
                            <div id="stepInfo" class="mt-3 text-center text-sm text-slate-400 font-mono"></div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                let array = [], cells = [], stateStack = [], currentStateIndex = -1;
                let isPlaying = false, isPaused = false, isSearching = false, speed = 1;
                let iterations = 0, target = 42, audioEnabled = false, audioCtx = null;

                function initAudio() { if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
                function playTone(freq, dur, type = 'sine') {
                    if (!audioEnabled || !audioCtx) return;
                    const o = audioCtx.createOscillator(), g = audioCtx.createGain();
                    o.connect(g); g.connect(audioCtx.destination);
                    o.frequency.value = freq; o.type = type;
                    g.gain.setValueAtTime(0.08, audioCtx.currentTime);
                    g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + dur);
                    o.start(); o.stop(audioCtx.currentTime + dur);
                }
                const sounds = { compare: () => playTone(500, 0.06), eliminate: () => playTone(300, 0.05), found: () => playTone(800, 0.15), notfound: () => playTone(200, 0.2) };

                const container = document.getElementById('arrayContainer');
                const sizeSlider = document.getElementById('sizeSlider'), sizeValue = document.getElementById('sizeValue');
                const speedSlider = document.getElementById('speedSlider'), speedValue = document.getElementById('speedValue');
                const targetInput = document.getElementById('targetInput'), targetDisplay = document.getElementById('targetDisplay');
                const statusBadge = document.getElementById('statusBadge');
                const iterationsEl = document.getElementById('iterations'), remainingEl = document.getElementById('remaining');
                const stepInfo = document.getElementById('stepInfo');
                const playIcon = document.getElementById('playIcon'), pauseIcon = document.getElementById('pauseIcon');
                const stepBackBtn = document.getElementById('stepBackBtn'), stepForwardBtn = document.getElementById('stepForwardBtn');
                const audioToggle = document.getElementById('audioToggle');

                sizeSlider.addEventListener('input', e => { sizeValue.textContent = e.target.value; if (!isSearching) generateArray(); });
                speedSlider.addEventListener('input', e => { speed = parseFloat(e.target.value); speedValue.textContent = speed + 'x'; });
                targetInput.addEventListener('change', e => { target = parseInt(e.target.value) || 0; targetDisplay.textContent = target; });
                audioToggle.addEventListener('change', e => { audioEnabled = e.target.checked; if (audioEnabled) initAudio(); });

                function setStatus(s) {
                    statusBadge.className = 'status-badge';
                    statusBadge.classList.add(s === 'Ready' ? 'status-ready' : s === 'Searching' ? 'status-searching' : s === 'Paused' ? 'status-paused' : s === 'Found' ? 'status-found' : 'status-notfound');
                    statusBadge.textContent = s;
                }

                function highlightCode(line) {
                    document.querySelectorAll('.code-line').forEach(el => el.classList.remove('active'));
                    if (line) document.querySelector(`.code-line[data-line="${line}"]`)?.classList.add('active');
                }

                function setRandomTarget() {
                    if (array.length > 0) {
                        target = array[Math.floor(Math.random() * array.length)];
                        targetInput.value = target;
                        targetDisplay.textContent = target;
                    }
                }

                function generateArray() {
                    if (isSearching) return;
                    container.innerHTML = ''; array = []; cells = []; stateStack = []; currentStateIndex = -1;
                    iterations = 0; iterationsEl.textContent = '0';
                    stepInfo.textContent = ''; highlightCode(null);

                    const size = parseInt(sizeSlider.value);
                    remainingEl.textContent = size;

                    // Generate sorted array
                    let val = Math.floor(Math.random() * 10) + 5;
                    for (let i = 0; i < size; i++) {
                        array.push(val);
                        val += Math.floor(Math.random() * 15) + 3;
                    }

                    array.forEach((v, i) => {
                        const cell = document.createElement('div');
                        cell.className = 'cell cell-idle';
                        cell.innerHTML = `<span class="index">${i}</span>${v}`;
                        container.appendChild(cell);
                        cells.push(cell);
                    });

                    setStatus('Ready'); updatePlayPauseBtn(); stepBackBtn.disabled = true; stepForwardBtn.disabled = true;
                }

                function captureState(info, codeLine, cellClasses) {
                    const state = { info, codeLine, cellClasses: cellClasses || cells.map(c => c.className), iterations };
                    if (currentStateIndex < stateStack.length - 1) stateStack = stateStack.slice(0, currentStateIndex + 1);
                    stateStack.push(state); currentStateIndex = stateStack.length - 1;
                }

                function restoreState(idx) {
                    if (idx < 0 || idx >= stateStack.length) return;
                    const s = stateStack[idx];
                    cells.forEach((c, i) => c.className = s.cellClasses[i]);
                    iterations = s.iterations; iterationsEl.textContent = iterations;
                    stepInfo.textContent = s.info; highlightCode(s.codeLine);
                    currentStateIndex = idx;
                    stepBackBtn.disabled = currentStateIndex <= 0;
                    stepForwardBtn.disabled = currentStateIndex >= stateStack.length - 1;
                }

                function stepBack() { if (currentStateIndex > 0) { isPaused = true; setStatus('Paused'); restoreState(currentStateIndex - 1); } }
                function stepForward() { if (currentStateIndex < stateStack.length - 1) restoreState(currentStateIndex + 1); }

                function updatePlayPauseBtn() {
                    if (isPlaying) { playIcon.classList.add('hidden'); pauseIcon.classList.remove('hidden'); document.getElementById('playPauseBtn').classList.replace('btn-play', 'btn-pause'); }
                    else { playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden'); document.getElementById('playPauseBtn').classList.replace('btn-pause', 'btn-play'); }
                }

                async function togglePlayPause() {
                    if (!isSearching) startSearch();
                    else if (isPlaying) { isPlaying = false; isPaused = true; setStatus('Paused'); updatePlayPauseBtn(); }
                    else { isPlaying = true; isPaused = false; setStatus('Searching'); updatePlayPauseBtn(); }
                }

                function sleep(ms) { return new Promise(r => { const check = () => { if (!isPaused) r(); else setTimeout(check, 50); }; setTimeout(check, ms / speed); }); }
                async function waitIfPaused() { while (isPaused && isSearching) await new Promise(r => setTimeout(r, 50)); }

                async function startSearch() {
                    isSearching = true; isPlaying = true; isPaused = false;
                    stateStack = []; currentStateIndex = -1;
                    target = parseInt(targetInput.value) || 0;
                    targetDisplay.textContent = target;
                    cells.forEach(c => c.className = 'cell cell-idle');
                    setStatus('Searching'); updatePlayPauseBtn();
                    stepBackBtn.disabled = false; stepForwardBtn.disabled = true;
                    iterations = 0; iterationsEl.textContent = '0';
                    captureState(`Searching for ${target}`, null);

                    const result = await binarySearch();

                    if (result !== -1) {
                        cells[result].className = 'cell cell-found';
                        sounds.found();
                        setStatus('Found');
                        stepInfo.textContent = `Found ${target} at index ${result}!`;
                    } else {
                        sounds.notfound();
                        setStatus('Not Found');
                        stepInfo.textContent = `${target} not found in array`;
                    }
                    captureState(stepInfo.textContent, null);
                    isSearching = false; isPlaying = false; updatePlayPauseBtn(); highlightCode(null);
                }

                async function binarySearch() {
                    let low = 0, high = array.length - 1;
                    highlightCode(1);
                    captureState(`Initialize: low=${low}, high=${high}`, 1);
                    await sleep(400);

                    while (low <= high) {
                        await waitIfPaused();
                        iterations++; iterationsEl.textContent = iterations;
                        remainingEl.textContent = high - low + 1;
                        highlightCode(2);

                        // Mark active range
                        for (let i = low; i <= high; i++) {
                            if (!cells[i].classList.contains('cell-eliminated')) cells[i].className = 'cell cell-active';
                        }
                        captureState(`Search range: [${low}..${high}]`, 2);
                        await sleep(350);

                        const mid = Math.floor((low + high) / 2);
                        cells[mid].className = 'cell cell-mid';
                        highlightCode(3);
                        sounds.compare();
                        stepInfo.textContent = `mid = ${mid}, arr[${mid}] = ${array[mid]}`;
                        captureState(`mid = ${mid}, arr[mid] = ${array[mid]}`, 3);
                        await sleep(500);

                        highlightCode(4);
                        if (array[mid] === target) {
                            highlightCode(5);
                            return mid;
                        }

                        if (array[mid] < target) {
                            highlightCode(6);
                            stepInfo.textContent = `${array[mid]} < ${target}, search right half`;
                            captureState(`${array[mid]} < ${target}, eliminate left`, 6);
                            await sleep(300);

                            // Color left as eliminated (going right)
                            for (let i = low; i <= mid; i++) cells[i].className = 'cell cell-eliminated';
                            // Color right as next search area
                            for (let i = mid + 1; i <= high; i++) cells[i].className = 'cell cell-right';
                            sounds.eliminate();
                            highlightCode(7);
                            captureState(`low = ${mid + 1}`, 7);
                            await sleep(400);
                            low = mid + 1;
                        } else {
                            highlightCode(8);
                            stepInfo.textContent = `${array[mid]} > ${target}, search left half`;
                            captureState(`${array[mid]} > ${target}, eliminate right`, 8);
                            await sleep(300);

                            // Color right as eliminated (going left)
                            for (let i = mid; i <= high; i++) cells[i].className = 'cell cell-eliminated';
                            // Color left as next search area
                            for (let i = low; i < mid; i++) cells[i].className = 'cell cell-left';
                            sounds.eliminate();
                            captureState(`high = ${mid - 1}`, 8);
                            await sleep(400);
                            high = mid - 1;
                        }
                    }
                    return -1;
                }

                window.addEventListener('resize', () => { if (!isSearching) generateArray(); });
                generateArray();
            </script>
</body>

</html>