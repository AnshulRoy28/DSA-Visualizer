<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BFS Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        .graph-container {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 16px;
            height: 400px;
            position: relative;
        }

        .node {
            position: absolute;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
            cursor: pointer;
            z-index: 10;
        }

        .node-idle {
            background: linear-gradient(135deg, #475569, #334155);
            border: 3px solid #64748b;
        }

        .node-queued {
            background: linear-gradient(135deg, #fcd34d, #f59e0b);
            border: 3px solid #fde68a;
            box-shadow: 0 0 25px rgba(251, 191, 36, 0.6);
        }

        .node-current {
            background: linear-gradient(135deg, #f87171, #ef4444);
            border: 3px solid #fca5a5;
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.7);
            transform: scale(1.15);
        }

        .node-visited {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            border: 3px solid #86efac;
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.5);
        }

        .edge {
            position: absolute;
            height: 3px;
            background: #475569;
            transform-origin: left center;
            z-index: 1;
            transition: background 0.3s;
        }

        .edge-visited {
            background: linear-gradient(90deg, #22c55e, #4ade80);
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
        }

        .queue-container {
            display: flex;
            gap: 8px;
            min-height: 50px;
            padding: 10px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .queue-item {
            background: linear-gradient(135deg, #fcd34d, #f59e0b);
            color: black;
            padding: 8px 14px;
            border-radius: 8px;
            font-weight: bold;
            font-family: 'JetBrains Mono', monospace;
            animation: pop-in 0.2s ease;
        }

        @keyframes pop-in {
            from {
                transform: scale(0);
            }

            to {
                transform: scale(1);
            }
        }

        .code-panel {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            line-height: 1.4;
        }

        .code-line {
            padding: 2px 6px;
            border-radius: 4px;
        }

        .code-line.active {
            background: rgba(59, 130, 246, 0.3);
            border-left: 3px solid #3b82f6;
        }

        .code-line-number {
            color: #64748b;
            width: 20px;
            display: inline-block;
            text-align: right;
            margin-right: 8px;
        }

        .btn-control {
            padding: 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-play {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        .btn-pause {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        .btn-step {
            background: rgba(71, 85, 105, 0.5);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }

        .btn-step:disabled {
            opacity: 0.4;
        }

        .metric {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 10px;
            padding: 8px;
            text-align: center;
        }

        .metric-value {
            font-size: 18px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            cursor: pointer;
        }

        .status-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-ready {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
        }

        .status-running {
            background: rgba(59, 130, 246, 0.2);
            color: #93c5fd;
        }

        .status-paused {
            background: rgba(245, 158, 11, 0.2);
            color: #fcd34d;
        }

        .status-complete {
            background: rgba(34, 197, 94, 0.2);
            color: #86efac;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 3px 6px;
            font-size: 10px;
        }

        .legend-color {
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }
    </style>
</head>

<body class="text-white">
    <div class="container mx-auto p-4 max-w-7xl">
        <header class="mb-4">
            <a href="../index.html"
                class="inline-flex items-center gap-2 text-slate-400 hover:text-blue-400 transition mb-2 text-sm">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                Back to Home
            </a>
            <div class="flex items-center gap-3">
                <div
                    class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-lg shadow-lg shadow-blue-500/30">
                    ðŸŒŠ</div>
                <div>
                    <h1
                        class="text-xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">
                        BFS Visualizer</h1>
                    <p class="text-slate-400 text-xs">Breadth-First Search â€¢ O(V+E) â€¢ Level-order traversal</p>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
            <div class="lg:col-span-4 space-y-3">
                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Controls</h2>
                    <div class="mb-3">
                        <label class="text-xs text-slate-400">Start Node</label>
                        <select id="startNode"
                            class="w-full bg-slate-700/50 border border-slate-600 rounded-lg px-3 py-2 text-sm mt-1">
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                            <option value="F">F</option>
                        </select>
                    </div>
                    <button onclick="resetGraph()"
                        class="w-full bg-gradient-to-r from-slate-600 to-slate-700 py-2 rounded-lg font-semibold text-xs">Reset
                        Graph</button>
                </div>

                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Playback</h2>
                    <div class="flex items-center justify-center gap-2 mb-3">
                        <button id="stepBackBtn" onclick="stepBack()" class="btn-control btn-step w-10 h-10" disabled>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.333 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z" />
                            </svg>
                        </button>
                        <button id="playPauseBtn" onclick="togglePlayPause()" class="btn-control btn-play w-12 h-12">
                            <svg id="playIcon" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z" />
                            </svg>
                            <svg id="pauseIcon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z" />
                            </svg>
                        </button>
                        <button id="stepForwardBtn" onclick="stepForward()" class="btn-control btn-step w-10 h-10"
                            disabled>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M11.933 12.8a1 1 0 000-1.6L6.6 7.2A1 1 0 005 8v8a1 1 0 001.6.8l5.333-4zM19.933 12.8a1 1 0 000-1.6l-5.333-4A1 1 0 0013 8v8a1 1 0 001.6.8l5.333-4z" />
                            </svg>
                        </button>
                    </div>
                    <div class="flex justify-between text-xs mb-1">
                        <span class="text-slate-400">Speed</span>
                        <span id="speedValue" class="text-blue-400 font-mono">1x</span>
                    </div>
                    <input type="range" id="speedSlider" min="0.5" max="5" step="0.5" value="1"
                        class="slider w-full h-2 bg-slate-700 rounded-lg">
                    <div class="flex items-center justify-between mt-2 pt-2 border-t border-slate-700/50">
                        <span class="text-slate-400 text-xs">Status</span>
                        <span id="statusBadge" class="status-badge status-ready">Ready</span>
                    </div>
                    <label class="flex items-center gap-2 text-xs text-slate-400 cursor-pointer mt-2">
                        <input type="checkbox" id="audioToggle" class="w-3 h-3 rounded">
                        <span>ðŸ”Š Audio</span>
                    </label>
                </div>

                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Metrics</h2>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="metric">
                            <div class="text-xs text-slate-400">Visited</div>
                            <div class="metric-value text-green-400" id="visitedCount">0</div>
                        </div>
                        <div class="metric">
                            <div class="text-xs text-slate-400">Queue Size</div>
                            <div class="metric-value text-yellow-400" id="queueSize">0</div>
                        </div>
                    </div>
                </div>

                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Algorithm</h2>
                    <div class="code-panel bg-slate-900/50 rounded-lg p-2">
                        <div class="code-line" data-line="1"><span class="code-line-number">1</span>queue.enqueue(start)
                        </div>
                        <div class="code-line" data-line="2"><span class="code-line-number">2</span>visited[start] =
                            true</div>
                        <div class="code-line" data-line="3"><span class="code-line-number">3</span><span
                                class="text-purple-400">while</span> !queue.empty():</div>
                        <div class="code-line" data-line="4"><span class="code-line-number">4</span> node =
                            queue.dequeue()</div>
                        <div class="code-line" data-line="5"><span class="code-line-number">5</span> process(node)</div>
                        <div class="code-line" data-line="6"><span class="code-line-number">6</span> <span
                                class="text-purple-400">for</span> neighbor in adj[node]:</div>
                        <div class="code-line" data-line="7"><span class="code-line-number">7</span> <span
                                class="text-purple-400">if</span> !visited[neighbor]:</div>
                        <div class="code-line" data-line="8"><span class="code-line-number">8</span>
                            queue.enqueue(neighbor)</div>
                    </div>
                </div>

                <div class="glass-card rounded-xl p-3">
                    <h2 class="text-xs font-semibold mb-2 text-slate-300">Legend</h2>
                    <div class="grid grid-cols-2 gap-1">
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(135deg, #475569, #334155)">
                            </div>Unvisited
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(135deg, #fcd34d, #f59e0b)">
                            </div>In Queue
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(135deg, #f87171, #ef4444)">
                            </div>Current
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(135deg, #4ade80, #22c55e)">
                            </div>Visited
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-8 space-y-3">
                <div class="glass-card rounded-xl p-4">
                    <h3 class="text-xs font-semibold text-slate-300 mb-2">Graph</h3>
                    <div id="graphContainer" class="graph-container"></div>
                </div>

                <div class="glass-card rounded-xl p-4">
                    <h3 class="text-xs font-semibold text-slate-300 mb-2">Queue (FIFO)</h3>
                    <div id="queueContainer" class="queue-container">
                        <span class="text-slate-500 text-sm">Queue is empty</span>
                    </div>
                    <div id="stepInfo" class="mt-2 text-center text-xs text-slate-400 font-mono"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const graph = {
            A: ['B', 'C'],
            B: ['A', 'D', 'E'],
            C: ['A', 'F'],
            D: ['B'],
            E: ['B', 'F'],
            F: ['C', 'E']
        };

        const nodePositions = {
            A: { x: 100, y: 180 },
            B: { x: 250, y: 80 },
            C: { x: 250, y: 280 },
            D: { x: 420, y: 50 },
            E: { x: 420, y: 180 },
            F: { x: 420, y: 300 }
        };

        let nodes = {}, edges = [], queue = [], visited = new Set(), stateStack = [], currentStateIndex = -1;
        let isPlaying = false, isPaused = false, isRunning = false, speed = 1;
        let visitedCount = 0, audioEnabled = false, audioCtx = null;

        function initAudio() { if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
        function playTone(freq, dur, type = 'sine') {
            if (!audioEnabled || !audioCtx) return;
            const o = audioCtx.createOscillator(), g = audioCtx.createGain();
            o.connect(g); g.connect(audioCtx.destination);
            o.frequency.value = freq; o.type = type;
            g.gain.setValueAtTime(0.08, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + dur);
            o.start(); o.stop(audioCtx.currentTime + dur);
        }
        const sounds = { enqueue: () => playTone(500, 0.06), dequeue: () => playTone(400, 0.06), visit: () => playTone(650, 0.1), done: () => playTone(800, 0.15) };

        const container = document.getElementById('graphContainer');
        const queueContainer = document.getElementById('queueContainer');
        const speedSlider = document.getElementById('speedSlider'), speedValue = document.getElementById('speedValue');
        const startNodeSelect = document.getElementById('startNode');
        const statusBadge = document.getElementById('statusBadge');
        const visitedCountEl = document.getElementById('visitedCount'), queueSizeEl = document.getElementById('queueSize');
        const stepInfo = document.getElementById('stepInfo');
        const playIcon = document.getElementById('playIcon'), pauseIcon = document.getElementById('pauseIcon');
        const stepBackBtn = document.getElementById('stepBackBtn'), stepForwardBtn = document.getElementById('stepForwardBtn');
        const audioToggle = document.getElementById('audioToggle');

        speedSlider.addEventListener('input', e => { speed = parseFloat(e.target.value); speedValue.textContent = speed + 'x'; });
        audioToggle.addEventListener('change', e => { audioEnabled = e.target.checked; if (audioEnabled) initAudio(); });

        function setStatus(s) {
            statusBadge.className = 'status-badge';
            statusBadge.classList.add(s === 'Ready' ? 'status-ready' : s === 'Running' ? 'status-running' : s === 'Paused' ? 'status-paused' : 'status-complete');
            statusBadge.textContent = s === 'Running' ? 'Running...' : s;
        }

        function highlightCode(line) {
            document.querySelectorAll('.code-line').forEach(el => el.classList.remove('active'));
            if (line) document.querySelector(`.code-line[data-line="${line}"]`)?.classList.add('active');
        }

        function drawEdge(from, to) {
            const p1 = nodePositions[from], p2 = nodePositions[to];
            const dx = p2.x - p1.x, dy = p2.y - p1.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;
            const edge = document.createElement('div');
            edge.className = 'edge';
            edge.id = `edge-${from}-${to}`;
            edge.style.width = `${length - 48}px`;
            edge.style.left = `${p1.x + 24}px`;
            edge.style.top = `${p1.y + 24}px`;
            edge.style.transform = `rotate(${angle}deg)`;
            container.appendChild(edge);
            edges.push({ from, to, el: edge });
        }

        function initGraph() {
            container.innerHTML = '';
            edges = [];
            const drawn = new Set();
            for (const node in graph) {
                for (const neighbor of graph[node]) {
                    const key = [node, neighbor].sort().join('-');
                    if (!drawn.has(key)) {
                        drawEdge(node, neighbor);
                        drawn.add(key);
                    }
                }
            }
            for (const node in nodePositions) {
                const el = document.createElement('div');
                el.className = 'node node-idle';
                el.textContent = node;
                el.style.left = `${nodePositions[node].x}px`;
                el.style.top = `${nodePositions[node].y}px`;
                container.appendChild(el);
                nodes[node] = el;
            }
        }

        function updateQueueDisplay() {
            if (queue.length === 0) {
                queueContainer.innerHTML = '<span class="text-slate-500 text-sm">Queue is empty</span>';
            } else {
                queueContainer.innerHTML = queue.map(n => `<div class="queue-item">${n}</div>`).join('');
            }
            queueSizeEl.textContent = queue.length;
        }

        function resetGraph() {
            if (isRunning) return;
            queue = []; visited.clear(); visitedCount = 0;
            visitedCountEl.textContent = '0'; queueSizeEl.textContent = '0';
            stateStack = []; currentStateIndex = -1;
            updateQueueDisplay(); stepInfo.textContent = ''; highlightCode(null);
            for (const node in nodes) nodes[node].className = 'node node-idle';
            edges.forEach(e => e.el.className = 'edge');
            setStatus('Ready'); updatePlayPauseBtn(); stepBackBtn.disabled = true; stepForwardBtn.disabled = true;
        }

        function captureState(info, codeLine) {
            const state = { queue: [...queue], visited: new Set(visited), nodeClasses: {}, edgeClasses: {}, info, codeLine };
            for (const n in nodes) state.nodeClasses[n] = nodes[n].className;
            edges.forEach((e, i) => state.edgeClasses[i] = e.el.className);
            if (currentStateIndex < stateStack.length - 1) stateStack = stateStack.slice(0, currentStateIndex + 1);
            stateStack.push(state); currentStateIndex = stateStack.length - 1;
        }

        function restoreState(idx) {
            if (idx < 0 || idx >= stateStack.length) return;
            const s = stateStack[idx];
            queue = [...s.queue]; visited = new Set(s.visited);
            for (const n in nodes) nodes[n].className = s.nodeClasses[n];
            edges.forEach((e, i) => e.el.className = s.edgeClasses[i]);
            visitedCount = visited.size; visitedCountEl.textContent = visitedCount;
            updateQueueDisplay();
            stepInfo.textContent = s.info; highlightCode(s.codeLine);
            currentStateIndex = idx;
            stepBackBtn.disabled = currentStateIndex <= 0;
            stepForwardBtn.disabled = currentStateIndex >= stateStack.length - 1;
        }

        function stepBack() { if (currentStateIndex > 0) { isPaused = true; setStatus('Paused'); restoreState(currentStateIndex - 1); } }
        function stepForward() { if (currentStateIndex < stateStack.length - 1) restoreState(currentStateIndex + 1); }

        function updatePlayPauseBtn() {
            if (isPlaying) { playIcon.classList.add('hidden'); pauseIcon.classList.remove('hidden'); document.getElementById('playPauseBtn').classList.replace('btn-play', 'btn-pause'); }
            else { playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden'); document.getElementById('playPauseBtn').classList.replace('btn-pause', 'btn-play'); }
        }

        async function togglePlayPause() {
            if (!isRunning) startBFS();
            else if (isPlaying) { isPlaying = false; isPaused = true; setStatus('Paused'); updatePlayPauseBtn(); }
            else { isPlaying = true; isPaused = false; setStatus('Running'); updatePlayPauseBtn(); }
        }

        function sleep(ms) { return new Promise(r => { const check = () => { if (!isPaused) r(); else setTimeout(check, 50); }; setTimeout(check, ms / speed); }); }
        async function waitIfPaused() { while (isPaused && isRunning) await new Promise(r => setTimeout(r, 50)); }

        async function startBFS() {
            isRunning = true; isPlaying = true; isPaused = false;
            stateStack = []; currentStateIndex = -1;
            resetGraph();
            setStatus('Running'); updatePlayPauseBtn();
            stepBackBtn.disabled = false; stepForwardBtn.disabled = true;

            const start = startNodeSelect.value;
            captureState(`Starting BFS from ${start}`, null);

            // Initialize
            queue.push(start);
            visited.add(start);
            nodes[start].className = 'node node-queued';
            updateQueueDisplay();
            highlightCode(1);
            sounds.enqueue();
            stepInfo.textContent = `Enqueue ${start}`;
            captureState(`Enqueue ${start}`, 1);
            await sleep(500);

            highlightCode(2);
            captureState(`Mark ${start} as visited`, 2);
            await sleep(300);

            while (queue.length > 0) {
                await waitIfPaused();
                highlightCode(3);

                const current = queue.shift();
                nodes[current].className = 'node node-current';
                updateQueueDisplay();
                highlightCode(4);
                sounds.dequeue();
                stepInfo.textContent = `Dequeue ${current}`;
                captureState(`Dequeue ${current}`, 4);
                await sleep(500);

                highlightCode(5);
                visitedCount++; visitedCountEl.textContent = visitedCount;
                stepInfo.textContent = `Process ${current}`;
                captureState(`Process ${current}`, 5);
                await sleep(400);

                // Explore neighbors
                highlightCode(6);
                for (const neighbor of graph[current]) {
                    await waitIfPaused();
                    highlightCode(7);
                    stepInfo.textContent = `Check neighbor ${neighbor}`;
                    captureState(`Check ${neighbor}`, 7);
                    await sleep(300);

                    if (!visited.has(neighbor)) {
                        visited.add(neighbor);
                        queue.push(neighbor);
                        nodes[neighbor].className = 'node node-queued';

                        // Mark edge
                        const edgeKey1 = `edge-${current}-${neighbor}`, edgeKey2 = `edge-${neighbor}-${current}`;
                        const edgeEl = document.getElementById(edgeKey1) || document.getElementById(edgeKey2);
                        if (edgeEl) edgeEl.className = 'edge edge-visited';

                        updateQueueDisplay();
                        highlightCode(8);
                        sounds.enqueue();
                        stepInfo.textContent = `Enqueue ${neighbor}`;
                        captureState(`Enqueue ${neighbor}`, 8);
                        await sleep(400);
                    }
                }

                nodes[current].className = 'node node-visited';
                sounds.visit();
                captureState(`${current} complete`, 5);
                await sleep(300);
            }

            sounds.done();
            setStatus('Complete');
            stepInfo.textContent = 'BFS Complete!';
            captureState('BFS Complete!', null);
            isRunning = false; isPlaying = false; updatePlayPauseBtn(); highlightCode(null);
        }

        initGraph();
        setStatus('Ready');
    </script>
</body>

</html>